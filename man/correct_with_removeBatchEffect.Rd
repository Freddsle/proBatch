% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/correct_batch_effects.R
\name{correct_with_removeBatchEffect}
\alias{correct_with_removeBatchEffect}
\title{Batch effect correction with removeBatchEffect from limma}
\usage{
correct_with_removeBatchEffect(
  x,
  sample_annotation,
  feature_id_col = "peptide_group_label",
  measure_col = "Intensity",
  sample_id_col = "FullRunName",
  batch_col = "MS_batch",
  format = c("long", "wide"),
  covariates_cols = NULL,
  fill_the_missing = NULL,
  keep_all = "default",
  ...
)
}
\arguments{
\item{x}{data in long (data.frame) or wide (matrix) form, controlled by \code{format}.}

\item{sample_annotation}{data frame with sample annotations}

\item{feature_id_col}{column name in \code{data_matrix} with feature IDs}

\item{measure_col}{column name in \code{data_matrix} with measured values}

\item{sample_id_col}{column name in \code{sample_annotation} with sample IDs}

\item{batch_col}{column name in \code{sample_annotation} with batch IDs}

\item{format}{one of \code{"long"} or \code{"wide"}.}

\item{covariates_cols}{optional sample_annotation columns for the design matrix.}

\item{fill_the_missing}{numeric value used to impute missing measurements
before correction. If \code{FALSE} rows with missing values are removed.}

\item{keep_all}{for long format, columns to retain (see \code{subset_keep_cols()}).}

\item{...}{other parameters to pass to \code{removeBatchEffect}}

\item{data_matrix}{data matrix with features in rows and samples in columns}
}
\value{
data matrix with batch effects removed
}
\description{
Batch effect correction with removeBatchEffect.

Removes batch-associated linear effects for plotting/unsupervised
tasks. Works for long or wide via \code{format}. Use \code{covariates_cols}
to keep biological effects in the design (not removed).
}
\examples{
data(
    list = c("example_sample_annotation", "example_proteome_matrix"),
    package = "proBatch"
)
batch_corrected_matrix <- correct_with_removeBatchEffect(
    example_proteome_matrix,
    example_sample_annotation,
    batch_col = "MS_batch",
    covariates_cols = c("Condition", "Type")
)
}
\seealso{
\code{\link{removeBatchEffect}}
}
