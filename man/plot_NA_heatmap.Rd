% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_missing.R
\name{plot_NA_heatmap}
\alias{plot_NA_heatmap}
\alias{plot_NA_heatmap.default}
\alias{plot_NA_heatmap.ProBatchFeatures}
\title{Plot missing-value heatmap(s)}
\usage{
plot_NA_heatmap(x, ...)

\method{plot_NA_heatmap}{default}(
  x,
  sample_annotation = NULL,
  sample_id_col = NULL,
  color_by = NULL,
  label_by = NULL,
  cluster_samples = TRUE,
  cluster_features = TRUE,
  show_row_dend = TRUE,
  show_column_dend = FALSE,
  missing_color = "black",
  valid_color = "grey90",
  col_vector = NULL,
  drop_complete = TRUE,
  draw = TRUE,
  main = NULL,
  ...
)

\method{plot_NA_heatmap}{ProBatchFeatures}(
  x,
  pbf_name = NULL,
  color_by = NULL,
  label_by = NULL,
  sample_id_col = NULL,
  cluster_samples = TRUE,
  cluster_features = TRUE,
  show_row_dend = TRUE,
  show_column_dend = FALSE,
  missing_color = "black",
  valid_color = "grey90",
  col_vector = NULL,
  drop_complete = TRUE,
  nrow = NULL,
  ncol = NULL,
  draw = TRUE,
  ...
)
}
\arguments{
\item{x}{A data container. For the `ProBatchFeatures` method this must be a
`ProBatchFeatures` object. The default method accepts any matrix-like input
(including `SummarizedExperiment`).}

\item{...}{Additional parameters forwarded to [pheatmap::pheatmap()].}

\item{sample_annotation}{Optional data frame with sample-level metadata. Row
names (or the column specified via `sample_id_col`) must match the column
names of the intensity matrix. When `x` is a `ProBatchFeatures` object the
sample annotation defaults to `as.data.frame(colData(x))`.}

\item{sample_id_col}{Optional column in `sample_annotation` providing unique
sample identifiers. Use this when the data frame lacks row names matching
the assay column names.}

\item{color_by}{Optional column name in `sample_annotation` used to annotate
heatmap columns. Use `NULL` (default) or the string "No" to omit the
annotation bar.}

\item{label_by}{Optional column name (or character vector) used for column
labels. Use `NULL` for default assay column names or the string "No" to
suppress column labels entirely.}

\item{cluster_samples, cluster_features}{Logical flags controlling whether the
heatmap columns/rows are clustered.}

\item{show_row_dend, show_column_dend}{Logical, whether dendrograms should be
drawn for the clustered rows/columns.}

\item{missing_color, valid_color}{Colours used for missing (`0`) and observed
(`1`) values respectively.}

\item{col_vector}{Optional vector of colours that will be recycled to colour
the unique values of `color_by`.}

\item{drop_complete}{Logical, drop features without any missing values before
plotting. Defaults to `TRUE` to focus on missingness patterns.}

\item{draw}{Logical, draw the heatmap(s). Set to `FALSE` to obtain the grob(s)
without plotting. For multiple assays, the arranged grob is returned
invisibly when `draw = TRUE`.}

\item{pbf_name}{Character scalar or vector with assay names to plot. When
`NULL`, the most recent assay returned by [pb_current_assay()] is used.
Only used by the `ProBatchFeatures` method.}

\item{nrow, ncol}{Integers controlling the layout when multiple assays are
plotted. If both are `NULL`, a roughly square layout is chosen
automatically.}
}
\value{
For a single assay the returned value is the `pheatmap` object. When
  multiple assays are requested a list is returned invisibly with elements
  `grob` (the arranged heatmaps) and `heatmaps` (individual `pheatmap`
  objects). Assays without missing values are skipped with a warning.
}
\description{
Functions for visualising the missingness pattern of assay intensities as a binary heatmap.
The `ProBatchFeatures` method supports drawing multiple assays at once by
arranging the resulting heatmaps into a user-controlled grid layout.
}
