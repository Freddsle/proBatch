% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/metadata_diagnostics.R
\name{filter_metadata_columns}
\alias{filter_metadata_columns}
\alias{filter_metadata_columns.default}
\alias{filter_metadata_columns.ProBatchFeatures}
\title{Filter metadata columns based on duplication and completeness}
\usage{
filter_metadata_columns(x, ...)

\method{filter_metadata_columns}{default}(
  x,
  duplicate_keep = c("first", "last", "pattern"),
  duplicate_pattern = NULL,
  pattern_ignore_case = TRUE,
  pattern_fixed = FALSE,
  min_non_na = NULL,
  max_pct_na = NULL,
  sort = FALSE,
  ...
)

\method{filter_metadata_columns}{ProBatchFeatures}(
  x,
  component = c("colData", "rowData"),
  assay = NULL,
  df = NULL,
  inplace = FALSE,
  ...
)
}
\arguments{
\item{x}{A data frame or `ProBatchFeatures` object.}

\item{...}{Additional arguments passed to specific methods.}

\item{duplicate_keep}{Strategy for selecting which column to retain within
each duplicated set. Choose between keeping the `"first"`, `"last"`, or the
first column whose name matches `duplicate_pattern` (`"pattern"`).}

\item{duplicate_pattern}{Character pattern used when
`duplicate_keep = "pattern"`. A regular expression is expected unless
`pattern_fixed = TRUE`.}

\item{pattern_ignore_case}{Logical flag passed to [base::grepl()] when
matching `duplicate_pattern`. Defaults to `TRUE` as metadata column names are
often case-insensitive.}

\item{pattern_fixed}{Forwarded to the `fixed` argument of [base::grepl()].
Defaults to `FALSE` to allow regular expressions.}

\item{min_non_na}{Optional minimum number of non-missing values a column must
contain to be retained. Set to `NULL` to skip this filter.}

\item{max_pct_na}{Optional maximum percentage (0â€“100) of missing values a
column may contain to be retained. Set to `NULL` to disable.}

\item{sort}{Logical flag forwarded to [metadata_column_summary()] while
computing missingness statistics. Has no impact on the returned data frame.}

\item{component}{Character string selecting which part of the object to
inspect. Defaults to sample metadata (`"colData"`); use `"rowData"` to
inspect feature metadata of a specific assay.}

\item{assay}{Optional single assay name used when `component = "rowData"`. If
omitted, the most recent assay returned by [pb_current_assay()] is used.}

\item{df}{Optional data frame. When supplied, `component` and `assay` are
ignored and the provided data frame is analysed instead.}

\item{inplace}{Logical flag; when `TRUE`, the filtered metadata replaces the
corresponding component inside the object. Defaults to `FALSE` to keep the
original object untouched.}
}
\value{
For data frames, a filtered data frame with attributes
  `"dropped_columns"`, `"dropped_duplicates"`, and `"dropped_missing"`
  describing the removal decisions. For `ProBatchFeatures` objects, either a
  filtered data frame (default) or the modified object when `inplace = TRUE`.
}
\description{
Automate common metadata cleaning steps by dropping duplicated columns while
retaining the preferred representative and optionally removing columns with
excessive missingness. Works on plain data frames as well as
[`ProBatchFeatures`] objects.
}
\examples{
metadata <- data.frame(
    `factor value intensity` = c(1, 2, 3),
    intensity = c(1, 2, 3),
    batch = c("A", NA, "B"),
    stringsAsFactors = FALSE,
    check.names = FALSE
)
filtered <- filter_metadata_columns(
    metadata,
    duplicate_keep = "pattern",
    duplicate_pattern = "^factor value",
    min_non_na = 2
)
names(filtered)

}
